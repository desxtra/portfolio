---
import "../styles/global.css";
---

<html lang="en">
  <head>
    <title>Destraxion Portfolio</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script defer>
      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("contact-form");
        const textarea = form.querySelector("textarea");
        const loader = document.getElementById("form-loader");

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          loader.classList.remove("hidden");

          const formData = new FormData(form);
          const data = new URLSearchParams(formData);

          try {
            const res = await fetch("https://portfolio-backend-tau-green.vercel.app/api", {
              method: "POST",
              headers: {
                "Content-Type": "application/x-www-form-urlencoded",
              },
              body: data,
            });

            const result = await res.json();
            loader.classList.add("hidden");
            if (result.status === "ok") {
              window.location.href = "/thankyou?auth=true";
            } else {
              alert("Failed to send message");
            }
          } catch (err) {
            loader.classList.add("hidden");
            alert("Error submitting the form.");
            console.error(err);
          }
        });

        textarea.addEventListener("keydown", (e) => {
          if (e.key === "Enter" && !e.shiftKey) {
            e.preventDefault();
            form.requestSubmit();
          }
        });
      });
    </script>

    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  </head>

  <body class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white font-sans min-h-screen flex items-center justify-center">
    <section class="w-full max-w-2xl bg-white text-gray-900 p-8 rounded-2xl shadow-xl relative overflow-hidden animate-fade-in">
      <div class="absolute top-0 right-0 transform translate-x-1/3 -translate-y-1/3">
        <lottie-player
          src="https://assets10.lottiefiles.com/packages/lf20_0yfsb3a1.json"
          background="transparent"
          speed="1"
          style="width: 150px; height: 150px"
          loop
          autoplay
        ></lottie-player>
      </div>

      <h2 class="text-3xl font-bold text-center mb-6">Let's Connect</h2>

      <form id="contact-form" class="space-y-4">
        <input
          type="text"
          name="name"
          placeholder="Your Name"
          required
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        />
        <input
          type="email"
          name="email"
          placeholder="Your Email"
          required
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        />
        <textarea
          name="message"
          placeholder="Type your message here... (Enter to send)"
          rows="4"
          required
          class="w-full px-4 py-3 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"
        ></textarea>

        <div class="flex justify-between items-center">
          <button
            type="submit"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition-all duration-200"
          >
            Send Message
          </button>
          <div id="form-loader" class="hidden animate-spin w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full"></div>
        </div>
      </form>

      <p class="mt-8 text-center text-sm text-gray-500">
        Thank you for visiting â€” more about me below
      </p>
    </section>
  </body>
</html>

<style>
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(40px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fade-in 0.8s ease-out;
  }
</style>